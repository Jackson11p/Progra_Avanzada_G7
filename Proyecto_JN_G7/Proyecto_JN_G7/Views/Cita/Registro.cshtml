@model Proyecto_JN_G7.Models.Citas

@{
    Layout = "_layoutExterno";
    ViewData["Title"] = "Registro de Cita";
}

<h3 class="card-title text-center mb-4">Registrar Cita</h3>

@if (ViewBag.Mensaje != null)
{
    <div class="alert alert-danger mt-3">@ViewBag.Mensaje</div>
}

<form asp-action="Registro" method="post" novalidate>
    <div class="mb-3">
        <label asp-for="PacienteID" class="form-label">ID del Paciente</label>
        <input asp-for="PacienteID" class="form-control" />
        <span asp-validation-for="PacienteID" class="text-danger"></span>
    </div>

    <div class="mb-3">
        <label asp-for="DoctorID" class="form-label">ID del Doctor</label>
        <input asp-for="DoctorID" class="form-control" />
        <span asp-validation-for="DoctorID" class="text-danger"></span>
    </div>

    <div class="mb-3">
        <label asp-for="FechaHora" class="form-label">Fecha y Hora de la Cita</label>
        <input asp-for="FechaHora" type="datetime-local" class="form-control" />
        <span asp-validation-for="FechaHora" class="text-danger"></span>
    </div>

    <div class="mb-3">
        <label asp-for="Estado" class="form-label">Estado</label>
        <input asp-for="Estado" class="form-control" value="Pendiente" />
        <span asp-validation-for="Estado" class="text-danger"></span>
    </div>

    <div class="mb-3">
        <label asp-for="MotivoConsulta" class="form-label">Motivo de la Consulta</label>
        <textarea asp-for="MotivoConsulta" class="form-control"></textarea>
        <span asp-validation-for="MotivoConsulta" class="text-danger"></span>
    </div>

    <!-- Campo oculto para la fecha de creación -->
    <input asp-for="FechaCreacion" type="hidden" id="FechaCreacion" />

    <div class="d-grid">
        <button type="submit" class="btn btn-primary">Registrar Cita</button>
    </div>

    <div class="mt-3 text-center">
        <a asp-controller="Home" asp-action="Index" class="text-muted">← Volver al inicio</a>
    </div>
</form>

@section Scripts {
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const now = new Date();
            const isoString = now.toISOString();
            document.getElementById("FechaCreacion").value = isoString;
        });
    </script>
}
